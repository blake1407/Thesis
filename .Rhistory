# Programmer Name: Ha Tran (Blake)
# Date: 11/19/24
# Summary; HW3 R
mpg<-read.csv("Car Mileage.csv")
#1
hypoth_ne_p<-function(a,b){
n_mpg<-length(a)
x_gt22<-length(a[a > 22])
phat_gt22<-round(x_gt22/n_mpg,2)
p0<-b
se_gt22<-round(sqrt(p0*(1-p0)/n_mpg),2)
z_gt22<-round((phat_gt22-p0)/se_gt22,2)
pvalue_gt22<-round(2* pnormGC(z_gt22,region = "above"),4)
col1<-c("Null:","Alt:","phat:","Standard Error:","Test Statistic:","P-value:")
col2<-c(paste("=",b), paste("not equal to",b), phat_gt22, se_gt22, z_gt22, pvalue_gt22)
results_p_gt22<-cbind(col1, col2)
return(results_p_gt22)
}
hypoth_ne_p(mpg$MPG,.40)
utils::install.packages("https://cran.r-project.org/bin/windows/contrib/4.3/lme4_1.1-35.5.zip",
repos = NULL)
setwd("C:/Users/nhath/Desktop/Thesis")
# utils::install.packages("https://cran.r-project.org/bin/windows/contrib/4.3/lme4_1.1-35.5.zip",
#                         repos = NULL)
library(tidyverse)
library(lmerTest)
library(lme4)
library(buildmer)
library(interactions)
interact_plot
data_pre = read.csv("Before_Stereotypes_Proportion_LIWC_Hate.csv")
# names(data_pre) = gsub("^Text", "\\1", names(data_pre))
data_pre = data_pre %>%
mutate(Condition_Contrast = -0.5)
data_post = read.csv("After_Stereotypes_Proportion_LIWC_Hate.csv")
# data_post = data_post[sample(1:1340, 65, replace=FALSE),]
# names(data_post) = gsub("^Text", "\\1", names(data_post))
data_post = data_post %>%
mutate(Condition_Contrast = 0.5)
# Print column names of both datasets
names(data_pre)
names(data_post)
data = merge(data_pre, data_post,
by=names(data_pre)[names(data_pre) %in% names(data_post)],
all = TRUE) %>%
distinct()
data = data %>%
mutate(ethorace_israelijewish = prop_Israeli + prop_Jewish + prop_IDF,
ethorace_arabicmuslim = prop_Arabic + prop_Muslim + prop_Hamas) %>%
mutate(Ethnorace = ifelse(ethorace_israelijewish > ethorace_arabicmuslim, -0.5,
ifelse(ethorace_arabicmuslim > ethorace_israelijewish, 0.5, NA)))
mod_negsentiment = lmer(tone_neg ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
# mod_negsentiment = lmer(tone_pos ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
#
# mod_warmstereotype = lmer(prop_Warm ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
# mod_coldstereotype = lmer(prop_Cold ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
# mod_compstereotype = lmer(prop_Competence ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
# mod_incompstereotype = lmer(prop_Incompetence ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
# mod_hatespeech = lmer(Hate_Score ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
# buildmer(tone_pos ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast|Subject_ID), data=data)
mod_negsentiment = lmer(tone_neg ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
buildmer(tone_neg ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast|Subject_ID), data=data)
buildmer(tone_pos ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast|Subject_ID), data=data)
buildmer(tone_neg ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast|Subject_ID), data=data)
mod_negsentiment = lmer(tone_neg ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace|Subject_ID), data=data)
mod_negsentiment = lmer(tone_neg ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace|Subject_ID), data=data)
mod_negsentiment = lmer(tone_neg ~ Ethnorace*Condition_Contrast + (1+ Ethnorace|Subject_ID), data=data)
mod_negsentiment = lmer(tone_neg ~ (1+ Ethnorace|Subject_ID), data=data)
mod_negsentiment = lmer(tone_neg ~ (1+ Ethnorace), data=data)
mod_negsentiment = lmer(tone_neg ~ (1+ Ethnorace), data=data)
mod_negsentiment = lmer(tone_neg ~ (1+ Ethnorace), data=data)
buildmer(tone_neg ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast|Subject_ID), data=data)
mod_negsentiment = lmer(tone_neg ~ 1+ Ethnorace, data=data)
mod_negsentiment = lmer(tone_neg ~ 1+ Ethnorace, data=data)
mod_negsentiment = lm(tone_neg ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
mod_negsentiment = lm(tone_neg ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
mod_negsentiment = lm(tone_neg ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
# utils::install.packages("https://cran.r-project.org/bin/windows/contrib/4.3/lme4_1.1-35.5.zip",
#                         repos = NULL)
library(tidyverse)
library(lmerTest)
library(lme4)
library(buildmer)
library(interactions)
interact_plot
data_pre = read.csv("Before_Stereotypes_Proportion_LIWC_Hate.csv")
# names(data_pre) = gsub("^Text", "\\1", names(data_pre))
data_pre = data_pre %>%
mutate(Condition_Contrast = -0.5)
data_post = read.csv("After_Stereotypes_Proportion_LIWC_Hate.csv")
# data_post = data_post[sample(1:1340, 65, replace=FALSE),]
# names(data_post) = gsub("^Text", "\\1", names(data_post))
data_post = data_post %>%
mutate(Condition_Contrast = 0.5)
# Print column names of both datasets
names(data_pre)
names(data_post)
data = merge(data_pre, data_post,
by=names(data_pre)[names(data_pre) %in% names(data_post)],
all = TRUE) %>%
distinct()
data = data %>%
mutate(ethorace_israelijewish = prop_Israeli + prop_Jewish + prop_IDF,
ethorace_arabicmuslim = prop_Arabic + prop_Muslim + prop_Hamas) %>%
mutate(Ethnorace = ifelse(ethorace_israelijewish > ethorace_arabicmuslim, -0.5,
ifelse(ethorace_arabicmuslim > ethorace_israelijewish, 0.5, NA)))
mod_negsentiment = lm(tone_neg ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
# mod_negsentiment = lmer(tone_pos ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
#
# mod_warmstereotype = lmer(prop_Warm ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
# mod_coldstereotype = lmer(prop_Cold ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
# mod_compstereotype = lmer(prop_Competence ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
# mod_incompstereotype = lmer(prop_Incompetence ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
# mod_hatespeech = lmer(Hate_Score ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
buildmer(tone_neg ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast|Subject_ID), data=data)
mod_negsentiment = lm(tone_neg ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
library(tidyverse)
library(lmerTest)
library(lme4)
library(car)
library(tidyverse)
library(lmerTest)
library(lme4)
install.packages("car")
library(car)
library(buildmer)
library(interactions)
buildmer(tone_neg ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast|Subject_ID), data=data)
mod_negsentiment = lm(tone_neg ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
mod_negsentiment = lm(tone_neg ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
mod_negsentiment = lm(tone_neg ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
mod_negsentiment = lmer(tone_neg ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
mod_negsentiment = lmer(tone_neg ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
mod_negsentiment = lmer(tone_neg ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
mod_negsentiment = lmer(tone_neg ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast|Subject_ID), data=data)
# Check for singular fit
isSingular(mod_negsentiment, tol = 1e-4)
# Extract the variance-covariance matrix of random effects
random_effects_vcov <- as.data.frame(VarCorr(mod_negsentiment))
# Print the variance-covariance matrix
print(random_effects_vcov)
# Calculate eigenvalues of the random effects covariance matrix
random_effects_matrix <- as.matrix(VarCorr(mod_negsentiment)$Subject_ID)
eigenvalues <- eigen(random_effects_matrix)$values
# Locate and print negative eigenvalues
negative_eigenvalues <- eigenvalues[eigenvalues < 0]
print(negative_eigenvalues)
mod_negsentiment = lmer(tone_neg ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast|Subject_ID), data=data)
# Check for singular fit
isSingular(mod_negsentiment, tol = 1e-4)
# Extract the variance-covariance matrix of random effects
random_effects_vcov <- as.data.frame(VarCorr(mod_negsentiment))
# Print the variance-covariance matrix
print(random_effects_vcov)
# Calculate eigenvalues of the random effects covariance matrix
random_effects_matrix <- as.matrix(VarCorr(mod_negsentiment)$Subject_ID)
eigenvalues <- eigen(random_effects_matrix)$values
# Locate and print negative eigenvalues
negative_eigenvalues <- eigenvalues[eigenvalues < 0]
print(negative_eigenvalues)
# Examine the random effects structure
ranef_structure <- ranef(mod_negsentiment)
print("Random Effects Structure:")
print(ranef_structure)
mod_negsentiment = lmer(tone_pos ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
mod_warmstereotype = lmer(prop_Warm ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
mod_coldstereotype = lmer(prop_Cold ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
mod_compstereotype = lmer(prop_Competence ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
mod_compstereotype = lmer(prop_Competence ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
mod_incompstereotype = lmer(prop_Incompetence ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
mod_hatespeech = lmer(Hate_Score ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast |Subject_ID), data=data)
mod_negsentiment = lmer(tone_neg ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast|Subject_ID), data=data,
control = lmerControl(tolerance = 1e-4))
mod_negsentiment = lmer(tone_neg ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast|Subject_ID), data=data, control = lmerControl(tolerance = 1e-4))
buildmer(Hate_Score ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast|Subject_ID), data=data)
mod_hatespeech = lmer(Hate_Score ~ 1 + Affiliation_Contrast + Ethnorace + Ethnorace:Affiliation_Contrast, data = data)
mod_hatespeech = lmer(Hate_Score ~ 1 + Affiliation_Contrast + Ethnorace + Ethnorace:Affiliation_Contrast, data = data)
mod_hatespeech = lmer(Hate_Score ~ 1 + Affiliation_Contrast + Ethnorace + Ethnorace:Affiliation_Contrast, data = data)
mod_hatespeech = lmer(Hate_Score ~ 1 + Affiliation_Contrast + Ethnorace + Ethnorace:Affiliation_Contrast, data = data)
mod_hatespeech = lmer(Hate_Score ~ 1 + Affiliation_Contrast + Ethnorace + Ethnorace:Affiliation_Contrast, data = data)
buildmer(Hate_Score ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast|Subject_ID), data=data)
mod_negsentiment = lmer(tone_neg ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast|Subject_ID), data=data, control = lmerControl(tolerance = 1e-4))
mod_negsentiment = lmer(tone_neg ~ Ethnorace + Affiliation_Contrast + Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast|Subject_ID), data=data)
mod_negsentiment = lmer(tone_neg ~ Ethnorace + Affiliation_Contrast + Condition_Contrast + (1+ Ethnorace + Affiliation_Contrast+ Condition_Contrast|Subject_ID), data=data)
mod_negsentiment = lmer(tone_pos ~ Ethnorace + Affiliation_Contrast + Condition_Contrast + (1+ Ethnorace + Affiliation_Contrast+ Condition_Contrast|Subject_ID), data=data)
mod_negsentiment = lmer(prop_Warm ~ Ethnorace + Affiliation_Contrast + Condition_Contrast + (1+ Ethnorace + Affiliation_Contrast+ Condition_Contrast|Subject_ID), data=data)
data = data %>%
mutate(ethorace_israelijewish = prop_Israeli + prop_Jewish + prop_IDF,
ethorace_arabicmuslim = prop_Arabic + prop_Muslim + prop_Hamas) %>%
mutate(Ethnorace = ifelse(ethorace_israelijewish > ethorace_arabicmuslim, -0.5,
ifelse(ethorace_arabicmuslim > ethorace_israelijewish, 0.5, NA)))
mod_negsentiment = lmer(prop_Cold ~ Ethnorace + Affiliation_Contrast + Condition_Contrast + (1+ Ethnorace + Affiliation_Contrast+ Condition_Contrast|Subject_ID), data=data)
mod_negsentiment = lmer(prop_Competence ~ Ethnorace + Affiliation_Contrast + Condition_Contrast + (1+ Ethnorace + Affiliation_Contrast+ Condition_Contrast|Subject_ID), data=data)
mod_negsentiment = lmer(prop_Incompetence ~ Ethnorace + Affiliation_Contrast + Condition_Contrast + (1+ Ethnorace + Affiliation_Contrast+ Condition_Contrast|Subject_ID), data=data)
mod_negsentiment = lmer(Hate_Score ~ Ethnorace + Affiliation_Contrast + Condition_Contrast + (1+ Ethnorace + Affiliation_Contrast+ Condition_Contrast|Subject_ID), data=data)
buildmer(Hate_Score ~ Ethnorace*Affiliation_Contrast*Condition_Contrast + (1+ Ethnorace*Affiliation_Contrast*Condition_Contrast|Subject_ID), data=data)
